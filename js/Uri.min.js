/*!
 * jsUri
 * https://github.com/derek-watson/jsUri
 *
 * Copyright 2013, Derek Watson
 * Released under the MIT license.
 *
 * Includes parseUri regular expressions
 * http://blog.stevenlevithan.com/archives/parseuri
 * Copyright 2007, Steven Levithan
 * Released under the MIT license.
 */
!function(t){function r(t){return t&&(t=t.toString().replace(o.pluses,"%20"),t=decodeURIComponent(t)),t}function e(t){var r=o.uri_parser,e=["source","protocol","authority","userInfo","user","password","host","port","isColonUri","relative","path","directory","file","query","anchor"],i=r.exec(t||""),s={}
return e.forEach(function(t,r){s[t]=i[r]||""}),s}function i(t){var e,i,s,n,h,u,a,f=[]
if("undefined"==typeof t||null===t||""===t)return f
for(0===t.indexOf("?")&&(t=t.substring(1)),i=t.toString().split(o.query_separator),e=0,a=i.length;a>e;e++)s=i[e],n=s.indexOf("="),0!==n&&(h=r(s.substring(0,n)),u=r(s.substring(n+1)),f.push(-1===n?[s,null]:[h,u]))
return f}function s(t){this.uriParts=e(t),this.queryPairs=i(this.uriParts.query),this.hasAuthorityPrefixUserPref=null}var o={starts_with_slashes:/^\/+/,ends_with_slashes:/\/+$/,pluses:/\+/g,query_separator:/[&;]/,uri_parser:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*)(?::([^:@]*))?)?@)?(\[[0-9a-fA-F:.]+\]|[^:\/?#]*)(?::(\d+|(?=:)))?(:)?)((((?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}
Array.prototype.forEach||(Array.prototype.forEach=function(t,r){var e,i
if(null==this)throw new TypeError(" this is null or not defined")
var s=Object(this),o=s.length>>>0
if("function"!=typeof t)throw new TypeError(t+" is not a function")
for(arguments.length>1&&(e=r),i=0;o>i;){var n
i in s&&(n=s[i],t.call(e,n,i,s)),i++}}),["protocol","userInfo","host","port","path","anchor"].forEach(function(t){s.prototype[t]=function(r){return"undefined"!=typeof r&&(this.uriParts[t]=r),this.uriParts[t]}}),s.prototype.hasAuthorityPrefix=function(t){return"undefined"!=typeof t&&(this.hasAuthorityPrefixUserPref=t),null===this.hasAuthorityPrefixUserPref?-1!==this.uriParts.source.indexOf("//"):this.hasAuthorityPrefixUserPref},s.prototype.isColonUri=function(t){return"undefined"==typeof t?!!this.uriParts.isColonUri:void(this.uriParts.isColonUri=!!t)},s.prototype.query=function(t){var r,e,s,o=""
for("undefined"!=typeof t&&(this.queryPairs=i(t)),r=0,s=this.queryPairs.length;s>r;r++)e=this.queryPairs[r],o.length>0&&(o+="&"),null===e[1]?o+=e[0]:(o+=e[0],o+="=","undefined"!=typeof e[1]&&(o+=encodeURIComponent(e[1])))
return o.length>0?"?"+o:o},s.prototype.getQueryParamValue=function(t){var r,e,i
for(e=0,i=this.queryPairs.length;i>e;e++)if(r=this.queryPairs[e],t===r[0])return r[1]},s.prototype.getQueryParamValues=function(t){var r,e,i,s=[]
for(r=0,i=this.queryPairs.length;i>r;r++)e=this.queryPairs[r],t===e[0]&&s.push(e[1])
return s},s.prototype.deleteQueryParam=function(t,e){var i,s,o,n,h,u=[]
for(i=0,h=this.queryPairs.length;h>i;i++)s=this.queryPairs[i],o=r(s[0])===r(t),n=s[1]===e,(1!==arguments.length||o)&&(2!==arguments.length||o&&n)||u.push(s)
return this.queryPairs=u,this},s.prototype.addQueryParam=function(t,r,e){return 3===arguments.length&&-1!==e?(e=Math.min(e,this.queryPairs.length),this.queryPairs.splice(e,0,[t,r])):arguments.length>0&&this.queryPairs.push([t,r]),this},s.prototype.hasQueryParam=function(t){var r,e=this.queryPairs.length
for(r=0;e>r;r++)if(this.queryPairs[r][0]==t)return!0
return!1},s.prototype.replaceQueryParam=function(t,e,i){var s,o,n=-1,h=this.queryPairs.length
if(3===arguments.length){for(s=0;h>s;s++)if(o=this.queryPairs[s],r(o[0])===r(t)&&decodeURIComponent(o[1])===r(i)){n=s
break}n>=0&&this.deleteQueryParam(t,r(i)).addQueryParam(t,e,n)}else{for(s=0;h>s;s++)if(o=this.queryPairs[s],r(o[0])===r(t)){n=s
break}this.deleteQueryParam(t),this.addQueryParam(t,e,n)}return this},["protocol","hasAuthorityPrefix","isColonUri","userInfo","host","port","path","query","anchor"].forEach(function(t){var r="set"+t.charAt(0).toUpperCase()+t.slice(1)
s.prototype[r]=function(r){return this[t](r),this}}),s.prototype.scheme=function(){var t=""
return this.protocol()?(t+=this.protocol(),this.protocol().indexOf(":")!==this.protocol().length-1&&(t+=":"),t+="//"):this.hasAuthorityPrefix()&&this.host()&&(t+="//"),t},s.prototype.origin=function(){var t=this.scheme()
return this.userInfo()&&this.host()&&(t+=this.userInfo(),this.userInfo().indexOf("@")!==this.userInfo().length-1&&(t+="@")),this.host()&&(t+=this.host(),(this.port()||this.path()&&this.path().substr(0,1).match(/[0-9]/))&&(t+=":"+this.port())),t},s.prototype.addTrailingSlash=function(){var t=this.path()||""
return"/"!==t.substr(-1)&&this.path(t+"/"),this},s.prototype.toString=function(){var t,r=this.origin()
return this.isColonUri()?this.path()&&(r+=":"+this.path()):this.path()?(t=this.path(),o.ends_with_slashes.test(r)||o.starts_with_slashes.test(t)?(r&&r.replace(o.ends_with_slashes,"/"),t=t.replace(o.starts_with_slashes,"/")):r+="/",r+=t):this.host()&&(this.query().toString()||this.anchor())&&(r+="/"),this.query().toString()&&(r+=this.query().toString()),this.anchor()&&(0!==this.anchor().indexOf("#")&&(r+="#"),r+=this.anchor()),r},s.prototype.clone=function(){return new s(this.toString())},"function"==typeof define&&define.amd?define(function(){return s}):"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=s:t.Uri=s}(this)
